# Party Automation Rules for MCP Gateway
#
# Maps JWT claims to NPL protocol parties.
# Party names use 'p' prefix to distinguish from JWT claim roles.
#
# Hierarchy:
# - pAdmin: Organization administrators (full control)
# - pAgent: AI agents / Gateway (tool invocation, policy checks)
#
# Note: Gateway uses built-in NPL 'observers' mechanism for read access.
# Admin adds Gateway as observer via addObserver permission.

# ============================================================================
# REGISTRY PACKAGE - Service Management
# ============================================================================

registry.ServiceRegistry:
  # Admin has full control
  pAdmin:
    set:
      claims:
        role:
          - admin

# ============================================================================
# SERVICES PACKAGE - Tool Governance
# ============================================================================

# Per-service ToolPolicy (V2 architecture)
services.ToolPolicy:
  # Admin creates instances, enables/disables tools
  pAdmin:
    set:
      claims:
        role:
          - admin
  # Agent checks access before forwarding to upstream
  pAgent:
    set:
      claims:
        role:
          - agent
          - admin  # Admin can also act as agent
