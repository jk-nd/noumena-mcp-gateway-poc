# Party Automation Rules for MCP Gateway (v4)
#
# Maps JWT claims to NPL protocol parties.
# Party names use 'p' prefix to distinguish from JWT claim roles.
#
# Hierarchy:
# - pAdmin: Organization administrators (policy management)
# - pGateway: Gateway system service (runtime policy enforcement)

# ============================================================================
# V4 GOVERNANCE — GatewayStore (unified singleton for catalog + access rules)
# ============================================================================

store.GatewayStore:
  pAdmin:
    set:
      claims:
        role:
          - admin
  pGateway:
    set:
      claims:
        role:
          - gateway

# ============================================================================
# V4 GOVERNANCE — ServiceGovernance (one instance per service)
# ============================================================================

governance.ServiceGovernance:
  pAdmin:
    set:
      claims:
        role:
          - admin
  pGateway:
    set:
      claims:
        role:
          - gateway
  pApprover:
    set:
      claims:
        role:
          - approver

# ============================================================================
# V4 GOVERNANCE — ToolAuthorization (workflow-gated tool execution)
# ============================================================================

governance.ToolAuthorization:
  pUser:
    set:
      claims:
        role:
          - user
          - admin
          - approver
  pGateway:
    set:
      claims:
        role:
          - gateway
